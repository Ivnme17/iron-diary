---
import Layout from '../layouts/Layout.astro';
---

<Layout title="DiarioDeHierro - Nuevo Entrenamiento (Demo)">
	<div class="min-h-screen bg-gray-900 py-8">
		<div class="max-w-2xl mx-auto">
			<h1 class="text-4xl font-bold mb-8 text-primary-500">Nuevo Entrenamiento (Demo)</h1>
			
			<form id="workoutForm" class="space-y-8 bg-gray-800 p-8 rounded-xl shadow-2xl border border-gray-700">
				<div>
					<label class="block text-sm font-medium text-gray-300 mb-2">Nombre del Entrenamiento</label>
					<input type="text" id="workoutName" placeholder="Ej: Entrenamiento de Fuerza" 
						class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-gray-100">
				</div>
				
				<div>
					<label class="block text-sm font-medium text-gray-300 mb-2">Fecha</label>
					<input type="date" id="workoutDate" 
						class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-gray-100">
				</div>
				
				<div>
					<div class="flex justify-between items-center mb-6">
						<h3 class="text-xl font-semibold text-gray-200">Ejercicios</h3>
						<button type="button" onclick="addExercise()" 
							class="bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors">
							Añadir Ejercicio
						</button>
					</div>
					
					<div id="exercisesList" class="space-y-6">
						<!-- Los ejercicios se añadirán aquí dinámicamente -->
					</div>
				</div>
				
				<div class="flex space-x-4 pt-6">
					<button type="button" onclick="saveWorkout()" 
						class="bg-primary-600 text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition-colors font-semibold">
						Guardar Entrenamiento
					</button>
					<a href="/demo-dashboard" class="bg-gray-700 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition-colors font-semibold">
						Cancelar
					</a>
				</div>
			</form>
			
			<div class="mt-8 text-center">
				<p class="text-gray-400">Esta es una versión demo. Para guardar tus entrenamientos, crea una cuenta.</p>
			</div>
		</div>
	</div>

	<script>
		let exerciseCount = 0;
		
		// Añadir un ejercicio por defecto al cargar
		addExercise();
		
		function addExercise(exerciseData = null) {
			exerciseCount++;
			const exercisesList = document.getElementById('exercisesList');
			
			const exerciseDiv = document.createElement('div');
			exerciseDiv.className = 'bg-gray-700 p-4 rounded-lg space-y-3 border border-gray-600';
			exerciseDiv.innerHTML = `
				<div class="flex justify-between items-center">
					<h4 class="font-medium text-gray-200">Ejercicio ${exerciseCount}</h4>
					<button type="button" onclick="removeExercise(this)" 
						class="text-red-500 hover:text-red-400 transition-colors">
						Eliminar
					</button>
				</div>
				<div class="grid grid-cols-2 gap-3">
					<div>
						<label class="block text-sm font-medium text-gray-300">Nombre</label>
						<input type="text" name="exercise_name_${exerciseCount}" 
							value="${exerciseData ? exerciseData.name : ''}"
							placeholder="Ej: Press de banca"
							class="mt-1 block w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-100">
					</div>
					<div>
						<label class="block text-sm font-medium text-gray-300 mb-2">Peso (kg)</label>
						<div class="flex items-center space-x-2">
							<input type="number" step="0.5" name="exercise_weight_${exerciseCount}" 
								value="${exerciseData ? exerciseData.weight : ''}"
								placeholder="Ej: 60"
								class="flex-1 mt-1 block px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-100">
							<div class="flex flex-col space-y-1">
								<button type="button" onclick="adjustWeight(${exerciseCount}, -2.5)" 
									class="bg-gray-600 text-white px-3 py-2 rounded hover:bg-gray-700 text-sm font-medium transition-colors">
									- 2.5 kg
								</button>
								<button type="button" onclick="adjustWeight(${exerciseCount}, 2.5)" 
									class="bg-primary-600 text-white px-3 py-2 rounded hover:bg-primary-700 text-sm font-medium transition-colors">
									+ 2.5 kg
								</button>
							</div>
						</div>
					</div>
					<div>
						<label class="block text-sm font-medium text-gray-300">Series</label>
						<input type="number" name="exercise_sets_${exerciseCount}" 
							value="${exerciseData ? exerciseData.sets : ''}"
							placeholder="Ej: 4"
							class="mt-1 block w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-100">
					</div>
					<div>
						<label class="block text-sm font-medium text-gray-300">Repeticiones</label>
						<input type="number" name="exercise_reps_${exerciseCount}" 
							value="${exerciseData ? exerciseData.reps : ''}"
							placeholder="Ej: 10"
							class="mt-1 block w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-100">
					</div>
				</div>
			`;
			
			exercisesList.appendChild(exerciseDiv);
		}
		
		function removeExercise(button) {
			const exercisesList = document.getElementById('exercisesList');
			if (exercisesList.children.length > 1) {
				button.closest('.bg-gray-700').remove();
			} else {
				alert('Debes tener al menos un ejercicio');
			}
		}
		
		function adjustWeight(exerciseId, delta) {
			const weightInput = document.querySelector(`input[name="exercise_weight_${exerciseId}"]`);
			if (weightInput) {
				const currentValue = parseFloat(weightInput.value) || 0;
				const newValue = Math.max(0, currentValue + delta);
				weightInput.value = newValue.toFixed(1);
				weightInput.dispatchEvent(new Event('input', { bubbles: true }));
			}
		}
		
		function saveWorkout() {
			const workoutName = document.getElementById('workoutName').value;
			const workoutDate = document.getElementById('workoutDate').value;
			
			if (!workoutName || !workoutDate) {
				alert('Por favor completa todos los campos');
				return;
			}
			
			// Simular guardado exitoso
			alert('¡Entrenamiento guardado exitosamente! (Demo)');
			
			// Redirigir al dashboard demo
			setTimeout(() => {
				window.location.href = '/demo-dashboard';
			}, 1000);
		}
	</script>
</Layout>
